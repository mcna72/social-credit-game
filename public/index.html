<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Social Credit Game - Multiplayer 3D Experience</title>
  
  <!-- Babylon.js -->
  <script src="https://cdn.babylonjs.com/babylon.js"></script>
  <script src="https://cdn.babylonjs.com/loaders/babylonjs.loaders.min.js"></script>
  <script src="https://cdn.babylonjs.com/postProcessesLibrary/babylonjs.postProcess.min.js"></script>
  
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 
                   'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue', sans-serif;
      overflow: hidden;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: #ffffff;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }
    
    #loading-screen {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, #0a0f1e 0%, #1a1f3e 100%);
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      z-index: 10000;
      transition: opacity 0.5s ease;
    }
    
    #loading-screen.hidden {
      opacity: 0;
      pointer-events: none;
    }
    
    .loader {
      width: 60px;
      height: 60px;
      border: 5px solid rgba(100, 150, 255, 0.2);
      border-top-color: #667eea;
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }
    
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
    
    .loading-text {
      margin-top: 30px;
      font-size: 24px;
      font-weight: 600;
      color: #90caf9;
      text-align: center;
    }
    
    .loading-subtext {
      margin-top: 10px;
      font-size: 14px;
      color: #64b5f6;
      opacity: 0.7;
    }
    
    .game-logo {
      font-size: 48px;
      font-weight: 800;
      margin-bottom: 40px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      letter-spacing: 2px;
    }
    
    #renderCanvas {
      width: 100%;
      height: 100%;
      touch-action: none;
    }
    
    /* Scrollbar styling */
    ::-webkit-scrollbar {
      width: 8px;
    }
    
    ::-webkit-scrollbar-track {
      background: rgba(255, 255, 255, 0.05);
      border-radius: 4px;
    }
    
    ::-webkit-scrollbar-thumb {
      background: rgba(100, 150, 255, 0.5);
      border-radius: 4px;
    }
    
    ::-webkit-scrollbar-thumb:hover {
      background: rgba(100, 150, 255, 0.7);
    }
    
    /* Mobile optimizations */
    @media (max-width: 768px) {
      .hud-panel {
        font-size: 12px !important;
        padding: 10px !important;
      }
      
      .score-display {
        font-size: 24px !important;
      }
      
      .hud-bottom {
        min-width: 90% !important;
      }
    }
    
    /* Welcome modal */
    #welcome-modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.8);
      backdrop-filter: blur(10px);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 9999;
      transition: opacity 0.3s ease;
    }
    
    #welcome-modal.hidden {
      opacity: 0;
      pointer-events: none;
    }
    
    .modal-content {
      background: linear-gradient(135deg, rgba(10, 15, 30, 0.95) 0%, rgba(26, 31, 62, 0.95) 100%);
      border: 2px solid rgba(100, 150, 255, 0.5);
      border-radius: 20px;
      padding: 40px;
      max-width: 500px;
      width: 90%;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
      text-align: center;
    }
    
    .modal-title {
      font-size: 36px;
      font-weight: 800;
      margin-bottom: 20px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    
    .modal-description {
      font-size: 16px;
      color: #b0b0b0;
      margin-bottom: 30px;
      line-height: 1.6;
    }
    
    .modal-input {
      width: 100%;
      padding: 15px;
      font-size: 16px;
      background: rgba(255, 255, 255, 0.1);
      border: 2px solid rgba(100, 150, 255, 0.3);
      border-radius: 10px;
      color: white;
      margin-bottom: 20px;
      transition: all 0.3s ease;
    }
    
    .modal-input:focus {
      outline: none;
      border-color: rgba(100, 150, 255, 0.6);
      box-shadow: 0 0 20px rgba(100, 150, 255, 0.2);
    }
    
    .modal-button {
      width: 100%;
      padding: 15px;
      font-size: 18px;
      font-weight: 600;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      border: none;
      border-radius: 10px;
      color: white;
      cursor: pointer;
      transition: transform 0.2s ease, box-shadow 0.2s ease;
    }
    
    .modal-button:hover {
      transform: scale(1.05);
      box-shadow: 0 10px 30px rgba(102, 126, 234, 0.4);
    }
    
    .modal-button:disabled {
      opacity: 0.5;
      cursor: not-allowed;
      transform: scale(1);
    }
    
    .controls-hint {
      position: fixed;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      background: rgba(10, 15, 30, 0.9);
      backdrop-filter: blur(10px);
      padding: 15px 30px;
      border-radius: 10px;
      border: 1px solid rgba(100, 150, 255, 0.3);
      font-size: 14px;
      color: #90caf9;
      text-align: center;
      z-index: 200;
      animation: fadeInUp 1s ease;
      pointer-events: none;
    }
    
    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translate(-50%, 20px);
      }
      to {
        opacity: 1;
        transform: translate(-50%, 0);
      }
    }
    
    .controls-hint.hidden {
      animation: fadeOutDown 0.5s ease forwards;
    }
    
    @keyframes fadeOutDown {
      to {
        opacity: 0;
        transform: translate(-50%, 20px);
      }
    }
    
    /* Performance indicator */
    #performance-indicator {
      position: fixed;
      top: 10px;
      left: 10px;
      background: rgba(10, 15, 30, 0.7);
      padding: 5px 10px;
      border-radius: 5px;
      font-size: 12px;
      color: #4CAF50;
      z-index: 300;
      font-family: 'Courier New', monospace;
    }
  </style>
</head>
<body>
  <!-- Loading Screen -->
  <div id="loading-screen">
    <div class="game-logo">SOCIAL CREDIT</div>
    <div class="loader"></div>
    <div class="loading-text">Laden van wereld...</div>
    <div class="loading-subtext">Een multiplayer sociale ervaring</div>
  </div>
  
  <!-- Welcome Modal -->
  <div id="welcome-modal">
    <div class="modal-content">
      <div class="modal-title">ðŸŽ® Welkom!</div>
      <div class="modal-description">
        Betreed een multiplayer wereld waar jouw sociale gedrag beloond of bestraft wordt.
        Chat met andere spelers en AI-bewoners, verzamel social credit punten!
      </div>
      <input 
        type="text" 
        id="username-input" 
        class="modal-input" 
        placeholder="Voer je naam in..."
        maxlength="20"
        autocomplete="off"
      >
      <button id="start-button" class="modal-button">Spel Starten</button>
    </div>
  </div>
  
  <!-- Controls Hint -->
  <div id="controls-hint" class="controls-hint">
    <strong>ðŸŽ® Besturing:</strong> WASD / Pijltjes = Bewegen | Shift = Sprint | Rechtermuisknop = Menu | Scroll = Zoom
  </div>
  
  <!-- Performance Indicator -->
  <div id="performance-indicator">FPS: --</div>
  
  <!-- Scripts -->
  <script src="app-ENHANCED.js"></script>
  
  <script>
    // Performance monitoring
    let lastFrameTime = performance.now();
    let fps = 60;
    
    function updatePerformance() {
      const now = performance.now();
      const delta = now - lastFrameTime;
      lastFrameTime = now;
      
      fps = Math.round(1000 / delta);
      
      const indicator = document.getElementById('performance-indicator');
      if (indicator) {
        indicator.textContent = `FPS: ${fps}`;
        indicator.style.color = fps >= 50 ? '#4CAF50' : fps >= 30 ? '#ff9800' : '#f44336';
      }
      
      requestAnimationFrame(updatePerformance);
    }
    
    requestAnimationFrame(updatePerformance);
    
    // Welcome modal handling
    document.addEventListener('DOMContentLoaded', () => {
      const modal = document.getElementById('welcome-modal');
      const input = document.getElementById('username-input');
      const button = document.getElementById('start-button');
      const loadingScreen = document.getElementById('loading-screen');
      const controlsHint = document.getElementById('controls-hint');
      
      // Focus input
      input.focus();
      
      // Handle enter key
      input.addEventListener('keypress', (e) => {
        if (e.key === 'Enter' && input.value.trim()) {
          startGame();
        }
      });
      
      // Handle button click
      button.addEventListener('click', startGame);
      
      function startGame() {
        const username = input.value.trim();
        
        if (!username) {
          input.style.borderColor = 'rgba(244, 67, 54, 0.6)';
          input.placeholder = 'Naam is verplicht!';
          return;
        }
        
        // Store username for game
        window.playerUsername = username;
        
        // Hide modal
        modal.classList.add('hidden');
        
        // Hide loading screen after a moment
        setTimeout(() => {
          loadingScreen.classList.add('hidden');
        }, 1000);
        
        // Hide controls hint after 10 seconds
        setTimeout(() => {
          if (controlsHint) {
            controlsHint.classList.add('hidden');
          }
        }, 10000);
      }
    });
  </script>
</body>
</html>
